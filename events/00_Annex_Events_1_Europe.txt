###########################
# Annexation Events concerning Europe
###########################
# By lots of folks
# Converted from on_actions to decisions by Rylock and Dr_Njitram
# Any new post-annexation events need to have their triggers in the KR_on_actions file
###########################
###########################
# Thanks KR ;) - Pax Team
###########################

## the bottom table of context and other events need to be adjusted to Pax - Lexus
## i left one event as example for the rest of the events, if you're not sure check out KR code

# Table of Contents
#	This might sound arcane to you, but we are following a center-west-north-east-south route. You'll get the hang of it
#
# Europe
#	Central Europe
#		Germany
#			Alsace
#			Luxemburg
#			Rheinland
#			North Germany
#			Schleswig
#			Prussia (+ East & West Prussia)
#			Posen
#			Masuria
#			Memel
#			Upper Silesia
#			Bavaria
#		Poland
#			Bialystok
#		UBD
#			Estonia
#			Latvia
#		Lithuania
#			Vilnius
#		Austria
#			Austria proper
#			Bohemia
#			Galicia
#				Bukovina
#			Hungary
#				Slovakia
#				Transcarpathia
#				Transylvania
#				West Banat
#				Vojvodina
#				Burgenland
#			Croatia
#				Dalmatia
#				Istria
#			Triest
#			Slovenia
#			Trentino
#		Switzerland
#			Romandy
#			Ticino
#
#	Western Europe
#		France
#			Brittany
#			Pas-de-Calais
#		Britain
#			Scotland
#			Wales
#		Ireland
#		Netherlands
#		Belgium
#			Wallonia
#
#	Northern Europe
#		Denmark
#			Iceland
#			Greenland
#		Norway
#		Sweden
#			Aland
#		Finland
#			Karelia
#
#	Eastern Europe
#		Ukraine
#			Brest
#		White Ruthenia
#			Eastern White Ruth.
#		European Russia
#			Dvinsk
#			Siberia
#
#	Southeastern Europe
#		Albania
#		Montenegro
#		Bosnia
#		Kosovo
#		Serbia
#			Nis
#			Macedonia
#		Romania
#		Bulgaria
#		Constantinople
#		Greece
#			Thessaloniki
#			Keraferia
#			Northern Epirus
#
#	Southern Europe
#		Spain
#			Galicia
#			Euskadi
#			Catalonia
#		Portugal
#		Southern France
#		Corsica
#		Italy
#			Aosta
#			Piedmont
#			Lombardy
#			Venetia
#			Emilia
#			Tuscany
#			Central Italy
#			Rome
#			Southern Italy
#			Sardinia
#		Malta

add_namespace = annexation

#####################################
##   C E N T R A L   E U R O P E   ##
#####################################

country_event = { #Fate of Alsace-Lorraine
	id = annexation.1001
	title = annexation_alsace_lorraine
	desc = annexation_alsace_lorraine_desc
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				OR = {
					785 = { is_claim_or_core_of_ROOT = yes } #Lorraine
					42 = { is_claim_or_core_of_ROOT = yes } #Palatinate
					780 = { is_claim_or_core_of_ROOT = yes } #Baden
				}
			}
			save_event_target_as = can_annex
		}
		if = {
			limit = {
				785 = { #Lorraine
					annexations_state_owner_is_valid_grant_target = yes
					owner = { ROOT_can_grant_land = yes }
				}
			}
			var:785.owner = { save_event_target_as = france }
		}
		if = {
			limit = {
				42 = { #Palatinate
					annexations_state_owner_is_valid_grant_target = yes
					owner = {
						NOT = { tag = event_target:france }
						ROOT_can_grant_land = yes
					}
				}
			}
			var:42.owner = { save_event_target_as = german_palatinate }
		}
		if = {
			limit = {
				780 = { #Baden
					annexations_state_owner_is_valid_grant_target = yes
					owner = {
						NOT = { tag = event_target:france }
						NOT = { tag = event_target:german_palatinate }
						ROOT_can_grant_land = yes
					}
				}
			}
			var:780.owner = { save_event_target_as = german_baden }
		}
	}

	option = { #Give to France
		log = "[GetLogInfo]: event annexation.1001 option annexation.give_to_france"
		name = annexation.give_to_france
		trigger = {
			has_event_target = france
		}
		ai_chance = {
			base = 70
			modifier = {
				factor = 0
				annexations_can_annex = yes
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:france }
				is_ally_with = event_target:german_palatinate
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:german_palatinate = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:france }
				is_ally_with = event_target:german_baden
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:german_baden = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0.1
				event_target:france = { is_subject = yes }
			}
		}
		set_temp_variable = { tag_to_release = event_target:france }
		28 = { transfer_state_and_notify = yes } #Alsace-Lorraine
		recheck_annexations = yes
	}

	option = { #Give to German tag 1 (owner of Palatinate)
		log = "[GetLogInfo]: event annexation.1001 option annexation.1001.a"
		name = annexation.1001.a
		trigger = {
			has_event_target = german_palatinate
		}
		ai_chance = {
			base = 15
			modifier = {
				factor = 0
				annexations_can_annex = yes
			}
			modifier = {
				factor = 0
				event_target:german_palatinate = { is_german_tag = yes }
				annexations_AI_country_wants_to_dismantle_germany = yes
			}
			modifier = {
				factor = 0
				is_ally_with = event_target:france
				event_target:france = {
					is_french_tag = yes
					is_subject = no
				}
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:german_palatinate }
				is_ally_with = event_target:france
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:france = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:german_palatinate }
				is_ally_with = event_target:german_baden
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:german_baden = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0.1
				event_target:german_palatinate = { is_subject = yes }
			}
		}
		set_temp_variable = { tag_to_release = event_target:german_palatinate }
		28 = { transfer_state_and_notify = yes } #Alsace-Lorraine
		recheck_annexations = yes
	}

	option = { #Give to German tag 2 (owner of Baden)
		log = "[GetLogInfo]: event annexation.1001 option annexation.1001.b"
		name = annexation.1001.b
		trigger = {
			has_event_target = german_baden
		}
		ai_chance = {
			base = 15
			modifier = {
				factor = 0
				annexations_can_annex = yes
			}
			modifier = {
				factor = 0
				event_target:german_baden = { is_german_tag = yes }
				annexations_AI_country_wants_to_dismantle_germany = yes
			}
			modifier = {
				factor = 0
				is_ally_with = event_target:france
				event_target:france = {
					is_french_tag = yes
					is_subject = no
				}
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:german_baden }
				is_ally_with = event_target:france
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:france = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0
				NOT = { is_ally_with = event_target:german_baden }
				is_ally_with = event_target:german_palatinate
				OR = {
					annexations_AI_country_wants_to_dismantle_germany = no
					event_target:german_palatinate = { is_german_tag = no }
				}
			}
			modifier = {
				factor = 0.1
				event_target:german_baden = { is_subject = yes }
			}
		}
		set_temp_variable = { tag_to_release = event_target:german_baden }
		28 = { transfer_state_and_notify = yes } #Alsace-Lorraine
		recheck_annexations = yes
	}

	option = { #Give to overlord
		log = "[GetLogInfo]: event annexation.1001 option annexation.give_to_overlord"
		name = annexation.give_to_overlord
		trigger = {
			annexations_should_give_lands_to_overlord = yes
		}
		set_temp_variable = { tag_to_release = overlord }
		28 = { transfer_state_and_notify = yes } #Alsace-Lorraine
		recheck_annexations = yes
	}

	option = { #Integrate
		log = "[GetLogInfo]: event annexation.1001 option annexation.integration"
		name = annexation.integration
		trigger = {
			annexations_can_annex = yes
		}
		28 = { add_claim_of_ROOT = yes } #Alsace-Lorraine
		recheck_annexations = yes
	}

	option = { #Cancel
		log = "[GetLogInfo]: event annexation.1001 option annexation.cancel"
		name = annexation.cancel
		ai_chance = { base = 0 }
		recheck_annexations = yes
	}
}

country_event = { #Fate of France
	id = annexation.1002
	title = annexation_france
	desc = annexation_france_desc
	picture = GFX_report_event_generic_map_france

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = { NOT = { country_exists = FRA } }
				FRA = { clear_cores_of_tag_if_possible = yes }
			}
			if = {
				limit = { NOT = { country_exists = OFA } }
				OFA = { clear_cores_of_tag_if_possible = yes }
			}
			random_other_country = {
				limit = {
					is_ally_with = ROOT
					OR = {
						is_subject = no
						is_subject_of = ROOT
					}
				}
				save_event_target_as = france
			}
			if = {
				limit = { NOT = { has_event_target = france } }
				if = {
					limit = { FRA = { ROOT_can_grant_land = yes } }
					FRA = { save_event_target_as = france }
				}
				else_if = {
					limit = { OFA = { ROOT_can_grant_land = yes } }
					OFA = { save_event_target_as = france }
				}
			}
			17 = { retain_state = yes } #Meurthe
			29 = { retain_state = yes } #Pas-de-Calais
			31 = { retain_state = yes } #Roussillon
			735 = { retain_state = yes } #Savoy
			785 = { retain_state = yes } #Picardy
			831 = { retain_state = yes } #Nice
			832 = { retain_state = yes } #Upper Savoy
			841 = { retain_state = yes } #Apurdi
			972 = { retain_state = yes } #Nauchatel
			1206 = { retain_state = yes } #Moselle
			1207 = { retain_state = yes } #Sedan
		}
	}

	#option = { #Restore the Commune of France!
	#	log = "[GetLogInfo]: event annex.1041 option annex.1041.a"
	#	name = annex.1041.a
	#	trigger = {
	#		has_socialist_government = yes
	#		NOT = { country_exists = FRA }
	#		is_french_tag = no
	#		is_subject = no
	#	}
	#	ai_chance = {
	#		base = 100
	#		modifier = {
	#			factor = 0
	#			annexations_AI_release_puppet_default_logic = yes
	#		}
	#	}
	#	set_temp_variable = { tag_to_release = FRA }
	#	every_state = {
	#		limit = { is_mainland_france_state = yes }
	#		add_core_of = var:tag_to_release
	#		hidden_effect = { remove_claim_by = var:tag_to_release }
	#	}
	#	release_targeted_tag = yes
	#	recheck_annexations = yes
	#}

	#option = { #Restore the French Republic!
	#	log = "[GetLogInfo]: event annex.1041 option annex.1041.b"
	#	name = annex.1041.b
	#	trigger = {
	#		is_ally_with = ENT
	#		NOT = { country_exists = NFA }
	#		has_socialist_government = no
	#		is_french_tag = no
	#		is_subject = no
	#	}
	#	ai_chance = {
	#		base = 100
	#		modifier = {
	#			factor = 0
	#			annexations_AI_release_puppet_default_logic = yes
	#		}
	#	}
	#	set_temp_variable = { tag_to_release = NFA }
	#	every_state = {
	#		limit = {
	#			is_mainland_france_state = yes
	#			NOT = { is_core_of = var:tag_to_release }
	#		}
	#		add_claim_by = var:tag_to_release
	#	}
	#	release_targeted_tag_with_claims = yes
	#	hidden_effect = { NFA_puppet_setup = yes }
	#	recheck_annexations = yes
	#}

	#option = { #Set up a French Puppet Government
	#	log = "[GetLogInfo]: event annex.1041 option annex.1041.c"
	#	name = annex.1041.c
	#	trigger = {
	#		NOT = { country_exists = FRP }
	#		OR = {
	#			NOT = { is_ally_with = ENT }
	#			NFA = {
	#				exists = yes
	#				NOT = { is_ally_with = ROOT }
	#			}
	#		}
	#		OR = {
	#			NOT = { is_ally_with = event_target:france }
	#			event_target:france = {
	#				is_subject = yes
	#				NOT = { is_subject_of = ROOT }
	#			}
	#		}
	#		has_socialist_government = no
	#		is_french_tag = no
	#		is_subject = no
	#	}
	#	ai_chance = {
	#		base = 70
	#		modifier = {
	#			factor = 0
	#			annexations_AI_release_puppet_default_logic = yes
	#		}
	#	}
	#	set_temp_variable = { tag_to_release = FRP }
	#	every_state = {
	#		limit = { is_mainland_france_state = yes }
	#		add_core_of = var:tag_to_release
	#		hidden_effect = { remove_claim_by = var:tag_to_release }
	#	}
	#	release_targeted_tag = yes
	#	if = {
	#		limit = { original_tag = GER }
	#		var:tag_to_release = { GER_setup_puppet_france = yes }
	#	}
	#	if = {
	#		limit = {
	#			NOT = { original_tag = GER }
	#		}
	#		hidden_effect = {
	#			var:tag_to_release = {
	#				country_event = frp.1
	#			}
	#		}
	#	}
	#	if = {
	#		limit = { country_exists = NFA }
	#		reverse_add_opinion_modifier = {
	#			target = NFA
	#			modifier = NFA_occupied_france
	#		}
	#	}
	#	recheck_annexations = yes
	#}
#
	#option = { #Give to France
	#	log = "[GetLogInfo]: event annex.1041 option annex.give_to_france"
	#	name = annex.give_to_france
	#	trigger = {
	#		has_event_target = france
	#	}
	#	ai_chance = {
	#		base = 70
	#		modifier = {
	#			factor = 0
	#			event_target:france = { annexations_AI_grant_land_default_logic = yes }
	#		}
	#	}
	#	set_temp_variable = { tag_to_release = event_target:france }
	#	every_owned_state = {
	#		limit = {
	#			is_mainland_france_state = yes
	#			is_allowed_annexation_state = yes
	#		}
	#		transfer_state_and_notify = yes
	#	}
	#	recheck_annexations = yes
	#}
#
	#option = { #Give to NFA
	#	log = "[GetLogInfo]: event annex.1041 option annex.europe.give_to_nfa"
	#	name = annex.europe.give_to_nfa
	#	trigger = {
	#		has_event_target = france_exile
	#		NOT = { original_tag = GER }
	#	}
	#	ai_chance = {
	#		base = 30
	#		modifier = {
	#			factor = 0
	#			event_target:france_exile = { annexations_AI_grant_land_default_logic = yes }
	#		}
	#	}
	#	set_temp_variable = { tag_to_release = event_target:france_exile }
	#	every_owned_state = {
	#		limit = {
	#			is_mainland_france_state = yes
	#			is_allowed_annexation_state = yes
	#		}
	#		transfer_state_and_notify = yes
	#	}
	#	recheck_annexations = yes
	#}
#
	#option = { #GER only: Meet with the French
	#	log = "[GetLogInfo]: event annex.1041 option annex.1041.d"
	#	name = annex.1041.d
	#	trigger = {
	#		original_tag = GER
	#		has_event_target = france_exile
	#		event_target:france_exile = { any_owned_state = { is_mainland_france_state = yes } }
	#	}
	#	ai_chance = { base = 30 }
	#	event_target:france_exile = { country_event = nfa.120 }
	#	recheck_annexations = yes
	#}

	option = {
		log = "[GetLogInfo]: event annex.1002 option annex.release_france"
		name = annexation.release_france
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				annexations_AI_release_puppet_default_logic = yes
			}
		}
		set_temp_variable = { tag_to_release = FRA }
		every_state = {
			limit = { is_starting_french_state = yes }
			add_claim_by = var:tag_to_release
			add_core_of = var:tag_to_release
		}

		release_targeted_tag = yes
		recheck_annexations = yes

	}

	option = {
		log = "[GetLogInfo]: event annex.1002 option annex.split_france"
		name = annexation.split_france
		trigger = {
			is_subject = no
		}
		ai_chance = { base = 0 }
		set_temp_variable = { tag_to_release = FRA }
		every_state = {
			limit = { is_only_releasable_france = yes }
		}
		release_targeted_tag = yes
		recheck_annexations = yes

	}

	option = { #Give to overlord
		log = "[GetLogInfo]: event annex.1041 option annex.give_to_overlord"
		name = annex.give_to_overlord
		trigger = {
			annexations_should_give_lands_to_overlord = yes
		}
		set_temp_variable = { tag_to_release = overlord }
		every_owned_state = {
			limit = {
				is_starting_french_state = yes
				is_allowed_annexation_state = yes
			}
			transfer_state_and_notify = yes
		}
		recheck_annexations = yes
	}

	option = { #Integrate
		log = "[GetLogInfo]: event annex.1041 option annex.integration"
		name = annex.integration
		trigger = {
			annexations_can_annex = yes
		}
		every_owned_state = {
			limit = { is_mainland_france_state = yes }
			add_claim_of_ROOT = yes
		}
		recheck_annexations = yes
	}

	option = { #Cancel
		log = "[GetLogInfo]: event annex.1041 option annex.cancel"
		name = annex.cancel
		ai_chance = { base = 0 }
		recheck_annexations = yes
	}
}

country_event = { #Fate of Burgundy
	id = annexation.1003
	title = annexation_burgundy
	desc = annexation_burgundy_desc
	picture = GFX_report_event_generic_map_france

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { 24 = { is_claim_or_core_of_ROOT = yes } } #Centre
			save_event_target_as = can_annex
		}
		if = {
			limit = {
				24 = { #Centre
					annexations_state_owner_is_valid_grant_target = yes
					owner = { ROOT_can_grant_land = yes }
				}
			}
			var:30.owner = { save_event_target_as = france }
		}
	}

	option = { #Liberate Burgundy
		log = "[GetLogInfo]: event annexation.1003 option annexation.1003.a"
		name = annexation.1003.a
		trigger = {
			is_subject = no
		}
		ai_chance = { base = 0 }
		set_temp_variable = { tag_to_release = BRG }
		17 = { remove_claim_and_add_core_of_target = yes } #Meurthe
		18 = { remove_claim_and_add_core_of_target = yes } #Champagne
		27 = { remove_claim_and_add_core_of_target = yes } #Bourgogne
		685 = { remove_claim_and_add_core_of_target = yes } #Champagne-Ardenne
		809 = { remove_claim_and_add_core_of_target = yes } #Franche-Comte
		release_targeted_tag = yes
		recheck_annexations = yes
	}

	option = { #give to France
		log = "[GetLogInfo]: event annex.1042 option annex.give_to_france"
		name = annex.give_to_france
		trigger = {
			has_event_target = france
		}
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				annexations_can_annex = yes
			}
			modifier = {
				factor = 0
				is_germany_or_splinter_tag = yes
			}
			modifier = {
				factor = 0.1
				event_target:france = { is_subject = yes }
			}
		}
		set_temp_variable = { tag_to_release = event_target:france }
		17 = { transfer_if_owned = yes } #Meurthe
		18 = { transfer_if_owned = yes } #Champagne
		27 = { transfer_if_owned = yes } #Bourgogne
		685 = { transfer_if_owned = yes } #Champagne-Ardenne
		809 = { transfer_if_owned = yes } #Franche-Comte
		recheck_annexations = yes
	}

	option = { #give to overlord
		log = "[GetLogInfo]: event annex.1042 option annex.give_to_overlord"
		name = annex.give_to_overlord
		trigger = {
			annexations_should_give_lands_to_overlord = yes
		}
		set_temp_variable = { tag_to_release = overlord }
		17 = { transfer_if_owned = yes } #Meurthe
		18 = { transfer_if_owned = yes } #Champagne
		27 = { transfer_if_owned = yes } #Bourgogne
		685 = { transfer_if_owned = yes } #Champagne-Ardenne
		809 = { transfer_if_owned = yes } #Franche-Comte
		recheck_annexations = yes
	}

	option = { #Integrate
		log = "[GetLogInfo]: event annex.1042 option annex.integration"
		name = annex.integration
		trigger = {
			annexations_can_annex = yes
		}
		14 = { add_claim_of_ROOT = yes } #Upper Brittany
		983 = { add_claim_of_ROOT = yes } #Brittany
		recheck_annexations = yes
	}

	option = { #Cancel
		log = "[GetLogInfo]: event annex.1042 option annex.cancel"
		name = annex.cancel
		ai_chance = { base = 0 }
		recheck_annexations = yes
	}
}
